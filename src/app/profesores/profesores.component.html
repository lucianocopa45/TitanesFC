<div class="registro-profesores-container">
  <h1 class="titulo-principal">Registro de Profesores</h1>


  <!-- Indicador de pasos -->
  <div class="pasos-indicador">
    <span [class.activo]="step === 1">1</span>
    <span [class.activo]="step === 2">2</span>
  </div>

  <!-- Paso 1: Datos Personales -->
  <form *ngIf="step === 1 && editandoProfesorId === null" [formGroup]="personalForm" class="formulario">
    <h2>Paso 1: Informaci√≥n Personal</h2>
    
    <div class="campo">
      <label for="nombre">Nombre*</label>
      <input id="nombre" formControlName="nombre" placeholder="Ingrese su nombre" />
      <div *ngIf="personalForm.get('nombre')?.touched && personalForm.get('nombre')?.invalid">
    <small *ngIf="personalForm.get('nombre')?.errors?.['required']">El nombre es obligatorio.</small>
    <small *ngIf="personalForm.get('nombre')?.errors?.['pattern']">Solo se permiten letras y espacios.</small>
  </div>
    </div>
    <div class="campo">
      <label for="apellido">Apellido*</label>
      <input id="apellido" formControlName="apellido" placeholder="Ingrese su apellido" />
      <div *ngIf="personalForm.get('apellido')?.touched && personalForm.get('apellido')?.invalid">
    <small *ngIf="personalForm.get('apellido')?.errors?.['required']">El apellido es obligatorio.</small>
    <small *ngIf="personalForm.get('apellido')?.errors?.['pattern']">Solo se permiten letras y espacios.</small>
  </div>
    </div>
    <div class="campo">
      <label for="dni">DNI*</label>
      <input id="dni" formControlName="dni" placeholder="Ingrese su DNI" />
      <div *ngIf="personalForm.get('dni')?.touched && personalForm.get('dni')?.invalid">
    <small *ngIf="personalForm.get('dni')?.errors?.['required']">El DNI es obligatorio.</small>
    <small *ngIf="personalForm.get('dni')?.errors?.['pattern']">Debe contener entre 7 y 10 n√∫meros.</small>
    <small *ngIf="personalForm.get('dni')?.errors?.['minlength']">M√≠nimo 7 d√≠gitos.</small>
    <small *ngIf="personalForm.get('dni')?.errors?.['maxlength']">M√°ximo 10 d√≠gitos.</small>
  </div>
    </div>
    <div class="campo">
      <label for="fechaNacimiento">Fecha de nacimiento*</label>
      <input id="fechaNacimiento" type="date" formControlName="fechaNacimiento" placeholder="dd/mm/aaaa" />
    </div>
    <div class="campo">
      <label for="direccion">Direcci√≥n*</label>
      <input id="direccion" formControlName="direccion" placeholder="Ingrese su direcci√≥n" />
    </div>
    <div class="campo">
      <label for="telefono">Tel√©fono*</label>
      <input id="telefono" formControlName="telefono" placeholder="Ingrese su tel√©fono" />
       <div *ngIf="personalForm.get('telefono')?.touched && personalForm.get('telefono')?.invalid">
    <small *ngIf="personalForm.get('telefono')?.errors?.['required']">El tel√©fono es obligatorio.</small>
    <small *ngIf="personalForm.get('telefono')?.errors?.['pattern']">Debe tener entre 7 y 15 d√≠gitos num√©ricos.</small>
  </div>
    </div>
    <div class="campo">
      <label for="especialidad">Especialidad*</label>
      <select id="especialidad" formControlName="especialidad" required>
    <option value="" disabled selected>Seleccione una especialidad</option>
    <option *ngFor="let esp of especialidades" [value]="esp">{{ esp }}</option>
  </select>
  </div>

    <div class="campo">
      <label for="actividades">Actividad*</label>
      <select id="actividades" formControlName="actividades" multiple title="actividades">
  <option *ngFor="let actividad of actividades" [value]="actividad.id_actividad">
    {{ actividad.nombre }} - {{ actividad.dia }} - {{ actividad.horario }} - {{ actividad.lugar }} (Cupo: {{ actividad.cupo_maximo }})
  </option>
</select>
<small>*Pod√©s seleccionar m√°s de una con Ctrl o Cmd</small>
    </div>

    <div class="botones">
      <button type="button" (click)="nextStep()" class="btn-rojo">Continuar</button>
    </div>
  </form>

  <!-- Paso 2: Datos de Usuario -->
  <form *ngIf="step === 2 && editandoProfesorId === null" [formGroup]="userForm" class="formulario">
    <h2>Paso 2: Datos de Usuario</h2>

    <div class="campo">
      <label for="correo">Correo*</label>
      <input id="correo" formControlName="correo" placeholder="Ingrese su Correo"/>
      <div *ngIf="userForm.get('correo')?.touched && userForm.get('correo')?.invalid">
    <small *ngIf="userForm.get('correo')?.errors?.['required']">El correo es obligatorio.</small>
    <small *ngIf="userForm.get('correo')?.errors?.['email']">Debe ser un correo v√°lido.</small>
  </div>
    </div>
    <div class="campo">
  <label for="contrasena">Contrase√±a*</label>
  <input id="contrasena" type="password" formControlName="contrasena" placeholder="Ingrese su contrase√±a" />
  <div *ngIf="userForm.get('contrasena')?.invalid && (userForm.get('contrasena')?.touched || userForm.get('contrasena')?.dirty)">
    <small *ngIf="userForm.get('contrasena')?.errors?.['required']">La contrase√±a es obligatoria.</small>
    <small *ngIf="userForm.get('contrasena')?.errors?.['minlength']">Debe tener al menos 6 caracteres.</small>
  </div>
</div>

<div class="campo">
  <label for="confirmarPasswrd">Confirmar Contrase√±a*</label>
  <input id="confirmarPasswrd" type="password" formControlName="confirmarContrasena" placeholder="Confirme su contrase√±a" />
  <div *ngIf="userForm.get('confirmarContrasena')?.touched && !matchPasswords()">
    <small>Las contrase√±as no coinciden.</small>
  </div>
</div>

    <div class="botones">
      <button type="button" (click)="prevStep()" class="btn-negro">Atr√°s</button>
    <button type="button" (click)="submit()" class="btn-rojo">
  Confirmar Registro
</button>
    </div>
  </form>
</div>
<!-- Tabla de profesores registrados -->
<div class="tabla-container" *ngIf="profesores.length > 0">
  <h2>Registro de profesores</h2>
  <table class="tabla-profesores">
    <thead>
      <tr>
        <td>ID</td>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>DNI</th>
        <th>F. Nacimiento</th>
        <th>Direcci√≥n</th>
        <th>Tel√©fono</th>
        <th>Especialidad</th>
        <th>Actividad</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
  <tr *ngFor="let p of profesores">
    <td>{{ p.id }}</td>
    <td>{{ p.nombre }}</td>
    <td>{{ p.apellido }}</td>
    <td>{{ p.dni }}</td>
    <td>{{ p.fechaNacimiento }}</td>
    <td>{{ p.direccion }}</td>
    <td>{{ p.telefono }}</td>
    <td>{{ p.especialidad }}</td>
    <td>
      <ul>
        <li *ngFor="let act of p.actividades">
          {{ act.nombre }} ({{ act.dia }} {{ act.horario }}) - {{ act.lugar }}
        </li>
      </ul>
    </td>
    <td><span class="estado-activo">Activo</span></td>
    <td>
          <!-- Botones de acci√≥n -->
          <button class="btn-editar" (click)="editarProfesor(p)">
            ‚úèÔ∏è
          </button>
          <button class="btn-eliminar" (click)="eliminarProfesor(p.id)">
            üóëÔ∏è
          </button>
        </td>
  </tr>
</tbody>
  </table>
</div>

<!-- Formulario de EDICI√ìN -->
<div class="editar-profesor-container" *ngIf="editandoProfesorId !== null">
  <h1>Editar Datos Personales del Profesor</h1>

  <form [formGroup]="editForm" class="formulario">
    <div class="campo">
      <label for="nombre">Nombre*</label>
      <input id="nombre" formControlName="nombre" />
    </div>
    <div class="campo">
      <label for="apellido">Apellido*</label>
      <input id="apellido" formControlName="apellido" />
    </div>
    <div class="campo">
      <label for="dni">DNI*</label>
      <input id="dni" formControlName="dni" />
    </div>
    <div class="campo">
      <label for="fechaNacimiento">Fecha de nacimiento*</label>
      <input id="fechaNacimiento" type="date" formControlName="fechaNacimiento" />
    </div>
    <div class="campo">
      <label for="direccion">Direcci√≥n*</label>
      <input id="direccion" formControlName="direccion" />
    </div>
    <div class="campo">
      <label for="telefono">Tel√©fono*</label>
      <input id="telefono" formControlName="telefono" />
    </div>
    <div class="campo">
  <label for="especialidad">Especialidad*</label>
  <select id="especialidad" formControlName="especialidad" required>
    <option value="" disabled selected>Seleccione una especialidad</option>
    <option *ngFor="let esp of especialidades" [value]="esp">{{ esp }}</option>
  </select>
</div>
    <div class="campo">
      <label for="actividades">Actividad*</label>
      <select id="actividades" formControlName="actividades" multiple title="actividades">
        <option *ngFor="let actividad of actividades" [value]="actividad.id_actividad">
          {{ actividad.nombre }} - {{ actividad.dia }} - {{ actividad.horario }} - {{ actividad.lugar }}
        </option>
      </select>
      <small>*Pod√©s seleccionar m√°s de una con Ctrl o Cmd</small>
    </div>

    <div class="botones">
      <button type="button" (click)="guardarEdicion()" class="btn-rojo">Guardar Cambios</button>
      <button type="button" (click)="cancelarEdicion()" class="btn-negro">Cancelar</button>
    </div>
  </form>
</div>